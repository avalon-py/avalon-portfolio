<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>QuantSim | Portfolio Architect</title>
    
    <!-- Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=JetBrains+Mono:wght@400;500;600&display=swap"
      rel="stylesheet"
    />
    
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              sans: ['Inter', 'sans-serif'],
              mono: ['JetBrains Mono', 'monospace'],
            },
            colors: {
              quant: {
                bg: '#ffffff',
                panel: '#f8f8f8',
                border: '#e5e5e5',
                text: '#171717',
                subtext: '#737373',
              }
            }
          }
        }
      }
    </script>
    <style>
        body { background-color: #ffffff; color: #171717; }
        .grid-bg {
            background-image: 
                linear-gradient(to right, #f0f0f0 1px, transparent 1px),
                linear-gradient(to bottom, #f0f0f0 1px, transparent 1px);
            background-size: 40px 40px;
        }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #f1f1f1; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #d4d4d4; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #a3a3a3; }
        
        /* Spinner Animation */
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .spinner { animation: spin 1s linear infinite; }
    </style>
  <script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^19.2.3",
    "lucide-react": "https://esm.sh/lucide-react@^0.562.0",
    "recharts": "https://esm.sh/recharts@^3.6.0",
    "react/": "https://esm.sh/react@^19.2.3/"
  }
}
</script>
<link rel="stylesheet" href="/index.css">
</head>
  <body class="h-screen flex flex-col overflow-hidden font-sans selection:bg-black selection:text-white text-quant-text">
    <div class="grid-bg fixed inset-0 -z-10"></div>
    
    <nav class="sticky top-0 z-50 border-b border-quant-border glass h-16 flex items-center justify-between px-6 md:px-12">
        <div class="flex items-center gap-3">
            <div class="w-4 h-4 bg-black"></div>
            <a href="index.html" class="font-semibold tracking-tight text-lg text-black hover:opacity-80 transition-opacity">
                QUANTSIM
            </a>
        </div>
        <div class="flex items-center gap-8 text-sm font-medium">
            <a href="index.html" class="text-quant-subtext hover:text-black transition-colors">Home</a>
            <a href="simulation.html" class="text-black">Simulator</a>
            <a href="technical.html" class="text-quant-subtext hover:text-black transition-colors">Technical</a>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="flex-1 flex overflow-hidden flex-col md:flex-row">
        
        <!-- Column 1: Portfolio Construction -->
        <aside class="w-full md:w-[350px] flex flex-col border-r border-quant-border bg-quant-panel h-full overflow-y-auto custom-scrollbar shadow-xl z-20 shrink-0">
            <div class="p-6 bg-white min-h-full">
                <div class="flex justify-between items-baseline mb-4">
                    <h2 class="text-xs font-bold uppercase tracking-widest text-black flex items-center gap-2">
                        <i data-lucide="pie-chart" class="w-3 h-3"></i> Portfolio
                    </h2>
                    <span class="text-[10px] text-quant-subtext font-mono">ALLOCATION</span>
                </div>

                <!-- Pie Chart Container -->
                <div id="pie-chart-container" class="h-32 w-full mb-6 relative hidden">
                     <canvas id="allocationChart"></canvas>
                </div>

                <!-- Toggle Type -->
                <div class="flex gap-2 mb-4 bg-gray-100 p-1 rounded-sm">
                    <button id="btn-std-asset" class="flex-1 text-[10px] uppercase font-bold py-2 transition-all bg-white shadow-sm text-black">Standard</button>
                    <button id="btn-custom-asset" class="flex-1 text-[10px] uppercase font-bold py-2 transition-all text-gray-500 hover:text-black">Custom</button>
                </div>

                <!-- Inputs -->
                <div class="space-y-3">
                    
                    <!-- Standard Asset Input -->
                    <div id="input-std-container" class="space-y-1">
                        <label class="block text-[10px] uppercase font-bold text-quant-subtext">Select Asset</label>
                        <div class="relative">
                            <select id="asset-select" class="w-full text-sm p-3 font-mono bg-white border border-quant-border focus:border-black focus:ring-0 appearance-none cursor-pointer hover:border-gray-400 transition-colors">
                                <!-- Options populated by JS -->
                            </select>
                            <div class="absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-gray-400">
                                <i data-lucide="plus" class="w-3 h-3 rotate-45"></i>
                            </div>
                        </div>
                    </div>

                    <!-- Custom Asset Inputs -->
                    <div id="input-custom-container" class="space-y-3 p-3 bg-gray-50 border border-quant-border hidden">
                        <div>
                            <label class="block text-[10px] uppercase font-bold text-quant-subtext">Ticker</label>
                            <input id="custom-ticker" type="text" class="w-full text-sm p-2 font-mono border border-quant-border" placeholder="e.g. TSLA">
                        </div>
                        <div class="grid grid-cols-2 gap-2">
                            <div>
                                <label class="block text-[10px] uppercase font-bold text-quant-subtext">CAGR (%)</label>
                                <input id="custom-cagr" type="number" step="0.01" class="w-full text-sm p-2 font-mono border border-quant-border" placeholder="12.5">
                            </div>
                            <div>
                                <label class="block text-[10px] uppercase font-bold text-quant-subtext">Vol (%)</label>
                                <input id="custom-vol" type="number" step="0.01" class="w-full text-sm p-2 font-mono border border-quant-border" placeholder="25.0">
                            </div>
                        </div>
                    </div>

                    <!-- Weight Input & Add -->
                    <div class="space-y-1">
                        <label class="block text-[10px] uppercase font-bold text-quant-subtext">Weight (%)</label>
                        <div class="flex gap-2">
                            <input id="weight-input" type="number" class="w-full text-sm p-3 font-mono border border-quant-border focus:border-black focus:ring-0 text-right" placeholder="0">
                            <button id="btn-add-asset" class="px-4 bg-black text-white hover:bg-gray-800 transition-colors flex items-center justify-center">
                                <i data-lucide="plus" class="w-4 h-4"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Asset List -->
                <div class="mt-6 border border-quant-border bg-white">
                    <div class="flex justify-between text-[10px] text-quant-subtext uppercase font-bold px-3 py-2 border-b border-quant-border bg-gray-50/50">
                        <span>Asset</span>
                        <span>Alloc.</span>
                    </div>
                    <ul id="portfolio-list" class="divide-y divide-quant-border max-h-[250px] overflow-y-auto">
                        <li class="text-quant-subtext text-xs italic py-6 text-center">No assets configured.</li>
                    </ul>
                    <div class="flex justify-between px-3 py-3 bg-gray-50 border-t border-quant-border">
                        <span class="text-xs font-bold text-black uppercase">Total</span>
                        <span id="total-weight-display" class="text-xs font-bold font-mono text-emerald-600">0.0%</span>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Column 2: Parameters -->
        <aside class="w-full md:w-[300px] flex flex-col border-r border-quant-border bg-gray-50/50 h-full overflow-y-auto custom-scrollbar z-10 shrink-0">
            <div class="p-6 space-y-6">
                <div class="flex justify-between items-baseline">
                    <h2 class="text-xs font-bold uppercase tracking-widest text-black flex items-center gap-2">
                        <i data-lucide="settings" class="w-3 h-3"></i> Parameters
                    </h2>
                    <span class="text-[10px] text-quant-subtext font-mono">KERNEL</span>
                </div>

                <div class="space-y-4">
                    <div class="space-y-1">
                        <label class="block text-[10px] uppercase font-bold text-quant-subtext">Initial Capital ($)</label>
                        <input id="param-initial" type="number" value="100000" class="w-full text-sm p-3 font-mono border border-quant-border focus:border-black focus:ring-0 bg-white">
                    </div>
                    <div class="space-y-1">
                        <label class="block text-[10px] uppercase font-bold text-quant-subtext">Annual Withdrawal ($)</label>
                        <input id="param-withdrawal" type="number" value="4000" class="w-full text-sm p-3 font-mono border border-quant-border focus:border-black focus:ring-0 bg-white">
                    </div>
                    <div class="grid grid-cols-2 gap-3">
                        <div class="space-y-1">
                            <label class="block text-[10px] uppercase font-bold text-quant-subtext">Inflation (%)</label>
                            <input id="param-inflation" type="number" value="2.5" class="w-full text-sm p-3 font-mono border border-quant-border focus:border-black focus:ring-0 bg-white">
                        </div>
                        <div class="space-y-1">
                            <label class="block text-[10px] uppercase font-bold text-quant-subtext">Years</label>
                            <input id="param-horizon" type="number" value="30" class="w-full text-sm p-3 font-mono border border-quant-border focus:border-black focus:ring-0 bg-white">
                        </div>
                    </div>
                </div>

                <!-- Advanced -->
                <div class="pt-4 border-t border-quant-border">
                    <div class="flex justify-between items-baseline mb-3">
                        <h3 class="text-[10px] font-bold uppercase tracking-widest text-quant-subtext flex items-center gap-1">
                            <i data-lucide="alert-circle" class="w-3 h-3"></i> Advanced
                        </h3>
                    </div>
                    <div class="space-y-3">
                        <label class="block p-3 border border-quant-border hover:bg-white cursor-pointer bg-white group transition-all">
                            <div class="flex items-center gap-3 mb-1">
                                <input id="check-correlations" type="checkbox" class="w-4 h-4 accent-black">
                                <span class="text-xs font-bold text-black">Asset Correlations</span>
                            </div>
                            <p class="text-[10px] text-quant-subtext leading-tight ml-7">
                                Models relationships between Asset Classes (Crypto, Equities, Metals).
                            </p>
                        </label>

                        <label class="block p-3 border border-quant-border hover:bg-white cursor-pointer bg-white group transition-all">
                            <div class="flex items-center gap-3 mb-1">
                                <input id="check-tails" type="checkbox" class="w-4 h-4 accent-black">
                                <span class="text-xs font-bold text-black">Fat Tail Events</span>
                            </div>
                            <p class="text-[10px] text-quant-subtext leading-tight ml-7">
                                Introduces rare but severe market crashes (3-sigma events) into the simulation.
                            </p>
                        </label>

                        <label class="block p-3 border border-quant-border hover:bg-white cursor-pointer bg-white group transition-all">
                            <div class="flex items-center gap-3 mb-1">
                                <input id="check-mean-reversion" type="checkbox" class="w-4 h-4 accent-black">
                                <span class="text-xs font-bold text-black">Mean Reversion</span>
                            </div>
                            <p class="text-[10px] text-quant-subtext leading-tight ml-7">
                                Adjusts annual returns to pull towards the long-term historical average.
                            </p>
                        </label>
                    </div>
                </div>

                <div class="pt-2">
                    <button id="btn-run-sim" class="w-full h-14 bg-black text-white font-bold uppercase tracking-widest text-sm disabled:opacity-50 disabled:cursor-not-allowed transition-all shadow-lg hover:bg-gray-800 flex items-center justify-center gap-3" disabled>
                        Run Simulation
                    </button>
                </div>
            </div>
        </aside>

        <!-- Column 3: Results Dashboard -->
        <section class="flex-1 flex flex-col relative bg-quant-bg h-full overflow-hidden min-w-0">
            
            <!-- Loading Overlay -->
            <div id="loading-overlay" class="absolute inset-0 z-50 bg-white/80 backdrop-blur-sm flex flex-col items-center justify-center hidden">
                <div class="flex items-center gap-3 mb-4">
                    <div id="status-indicator" class="w-2 h-2 rounded-full bg-yellow-400 animate-pulse"></div>
                    <div id="status-text" class="text-xs font-bold tracking-[0.2em] text-black">PROCESSING MODEL</div>
                </div>
                <div class="w-8 h-8 border-2 border-gray-200 border-t-black rounded-full spinner"></div>
                <div class="text-[10px] font-mono text-quant-subtext mt-4">10,000 MONTE CARLO ITERATIONS</div>
            </div>

            <!-- Empty State -->
            <div id="empty-state" class="flex-1 flex flex-col items-center justify-center bg-gray-50 text-quant-subtext">
                <div class="w-16 h-16 border-2 border-dashed border-gray-300 rounded-full mb-4"></div>
                <p class="text-sm font-medium tracking-wide uppercase">Awaiting Simulation</p>
                <p class="text-xs mt-2 opacity-60">Configure portfolio and run parameters</p>
            </div>

            <!-- Results Content -->
            <div id="results-content" class="flex flex-col h-full hidden">
                
                <!-- Metrics Header -->
                <div class="h-auto min-h-[100px] border-b border-quant-border bg-white flex flex-wrap shrink-0 divide-x divide-quant-border">
                    <!-- Risk -->
                    <div class="flex-1 min-w-[140px] px-6 py-4 flex flex-col justify-center hover:bg-gray-50 transition-colors">
                        <div class="flex items-center gap-2 mb-1">
                            <span class="text-[10px] uppercase text-quant-subtext font-bold tracking-wider">Risk of Ruin</span>
                            <div id="risk-dot" class="w-1.5 h-1.5 rounded-full bg-emerald-500"></div>
                        </div>
                        <span id="metric-risk" class="text-3xl font-mono font-medium tracking-tighter text-emerald-600">0.00%</span>
                    </div>
                    <!-- Median Final -->
                    <div class="flex-1 min-w-[140px] px-6 py-4 flex flex-col justify-center hover:bg-gray-50 transition-colors">
                        <span class="text-[10px] uppercase text-quant-subtext font-bold tracking-wider mb-1">Median Final</span>
                        <span id="metric-median" class="text-3xl font-mono font-medium text-black tracking-tighter">$0.0k</span>
                    </div>
                    <!-- CAGR -->
                    <div class="flex-1 min-w-[140px] px-6 py-4 flex flex-col justify-center hover:bg-gray-50 transition-colors">
                        <span class="text-[10px] uppercase text-quant-subtext font-bold tracking-wider mb-1">Exp. CAGR</span>
                        <span id="metric-cagr" class="text-3xl font-mono font-medium text-black tracking-tighter">0.00%</span>
                    </div>
                    <!-- Vol -->
                    <div class="flex-1 min-w-[140px] px-6 py-4 flex flex-col justify-center hover:bg-gray-50 transition-colors">
                        <span class="text-[10px] uppercase text-quant-subtext font-bold tracking-wider mb-1">Volatility</span>
                        <span id="metric-vol" class="text-3xl font-mono font-medium text-black tracking-tighter">0.00%</span>
                    </div>
                </div>

                <!-- Chart Area -->
                <div class="flex-1 p-8 bg-white relative w-full h-full min-h-0">
                    <div class="absolute top-4 left-8 right-8 flex justify-between items-center z-10 pointer-events-none">
                        <h3 class="text-xs font-bold uppercase text-black tracking-widest bg-white/50 px-2">Projection Analysis</h3>
                        <div class="flex gap-4 bg-white/50 px-2 rounded">
                            <div class="flex items-center gap-2">
                                <div class="w-3 h-0.5 bg-emerald-500"></div>
                                <span class="text-[10px] uppercase font-bold text-quant-subtext">95th %ile</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <div class="w-3 h-0.5 bg-black"></div>
                                <span class="text-[10px] uppercase font-bold text-quant-subtext">Median</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <div class="w-3 h-0.5 bg-red-500"></div>
                                <span class="text-[10px] uppercase font-bold text-quant-subtext">5th %ile</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="w-full h-full">
                        <canvas id="resultsChart"></canvas>
                    </div>
                </div>
            </div>

        </section>
    </main>

    <script type="module" src="js/main.js"></script>
  <script type="module" src="/index.tsx"></script>
</body>
</html>
